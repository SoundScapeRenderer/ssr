language: cpp

compiler:
  #  - clang
  - gcc

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: required
    - os: osx
      osx_image: xcode9.2
      env:
        - PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
          #  allow_failures:
          #    - compiler: clang

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sudo rm /usr/local/include/c++; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update; fi

install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install --c++11 asio autoconf doxygen ecasound fftw help2man jack libsndfile qt4; fi
  # autotools, automake, make are present in the trusty image
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get install -y g++ libasio-dev libqt4-dev libqt4-opengl-dev libecasoundc-dev ecasound libxml2-dev libfftw3-dev libsndfile1-dev libjack-dev libjack0 jackd1 pkg-config libtool; fi

before_script:
  - ci/install-deps.sh
  - autoreconf -vfi

script:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ./configure --enable-app-bundle; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ./configure --prefix='/usr'; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then make dmg; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then make && sudo make install; fi

branches:
  only:
    - master
    - networking-with-osc
    - travis-integration

# vim:set ts=2 sw=2 et:
