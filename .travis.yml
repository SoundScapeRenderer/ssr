language: cpp

compiler:
  - clang
  - gcc

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: required
    - os: osx
      osx_image: xcode9.2
      env:
        - PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
          #  allow_failures:
          #    - compiler: clang

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sudo rm /usr/local/include/c++; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update; fi

install:
  - ci/install-deps.sh

before_script:
  - ci/build-deps.sh
  - autoreconf -vfi

script:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ./configure --enable-app-bundle; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ./configure --prefix='/usr'; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then make dmg; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then make && sudo make install; fi

after_failure:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]] -a [[ -f config.log ]]; then cat config.log; fi

branches:
  only:
    - master
    - networking-with-osc
    - travis-integration

# vim:set ts=2 sw=2 et:
